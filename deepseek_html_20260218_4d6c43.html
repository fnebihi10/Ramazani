<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Ramadan 30 ¬∑ Dhikr & Namaze</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
        }

        body {
            background: #1e2b36;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding: 10px;
        }

        .app-container {
            width: 100%;
            max-width: 480px;
            background: #fef9e7;
            border-radius: 32px 32px 24px 24px;
            box-shadow: 0 20px 30px rgba(0,0,0,0.3);
            border: 1px solid #c9a03d40;
        }

        .header {
            background: #1e2b36;
            padding: 24px 20px 18px;
            color: #fef9e7;
            text-align: center;
            border-bottom: 3px solid #c9a03d;
        }

        .header h1 {
            font-weight: 400;
            font-size: 2rem;
        }

        .header h1 span {
            font-weight: 300;
            font-size: 1rem;
            display: block;
            color: #c9a03d;
        }

        .day-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #fffcf2;
            padding: 12px 20px;
            border-bottom: 1px solid #e5d9c7;
        }

        .nav-btn {
            background: none;
            border: 2px solid #c9a03d;
            color: #1e2b36;
            font-size: 1.8rem;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: bold;
        }

        .nav-btn:active {
            background: #c9a03d;
            color: white;
        }

        .day-display {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e2b36;
        }

        .day-display small {
            font-size: 1rem;
            font-weight: 400;
            color: #7f8c8d;
        }

        .content {
            padding: 20px;
            padding-bottom: 30px;
            max-height: 70vh;
            overflow-y: auto;
            scrollbar-width: thin;
        }

        .section {
            margin-bottom: 28px;
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1e2b36;
            border-left: 6px solid #c9a03d;
            padding-left: 12px;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* prayer grid */
        .prayer-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .prayer-item {
            background: white;
            border-radius: 30px;
            padding: 8px 12px 8px 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            border: 1px solid #e5d9c7;
        }

        .prayer-item input[type="checkbox"] {
            width: 26px;
            height: 26px;
            accent-color: #c9a03d;
        }

        .prayer-name {
            font-weight: 600;
            color: #1e2b36;
        }

        .prayer-name small {
            font-weight: 400;
            font-size: 0.7rem;
            color: #8e7b5e;
            display: block;
        }

        /* dhikr cards */
        .dhikr-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .dhikr-card {
            background: white;
            border-radius: 20px;
            padding: 12px 15px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            border: 1px solid #e5d9c7;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }

        .dhikr-check {
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 40px;
        }

        .dhikr-check input[type="checkbox"] {
            width: 22px;
            height: 22px;
            accent-color: #c9a03d;
        }

        .dhikr-text {
            flex: 2;
            font-size: 0.95rem;
            color: #1e2b36;
            line-height: 1.4;
            min-width: 180px;
        }

        .arabic-note {
            font-size: 0.85rem;
            color: #c9a03d;
            font-style: italic;
        }

        .dhikr-counter {
            display: flex;
            align-items: center;
            gap: 6px;
            background: #f8f3e9;
            border-radius: 40px;
            padding: 4px 12px;
        }

        .dhikr-counter input {
            width: 65px;
            border: none;
            border-bottom: 1px solid #c9a03d;
            background: transparent;
            text-align: center;
            font-size: 1rem;
            padding: 4px 0;
        }

        .dhikr-counter input:focus {
            outline: none;
        }

        /* input groups */
        .input-row {
            background: white;
            border-radius: 20px;
            padding: 12px 18px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 1px solid #e5d9c7;
        }

        .input-row label {
            font-weight: 600;
            min-width: 110px;
            color: #1e2b36;
        }

        .input-row input, .input-row textarea {
            flex: 1;
            border: none;
            border-bottom: 1px dashed #c9a03d;
            background: transparent;
            padding: 6px 0;
            font-size: 1rem;
        }

        .input-row textarea {
            border: 1px solid #eee;
            border-radius: 12px;
            padding: 8px;
            min-height: 60px;
        }

        .full-width {
            flex-direction: column;
            align-items: flex-start;
            gap: 6px;
        }

        .full-width textarea {
            width: 100%;
        }

        .save-btn {
            background: #c9a03d;
            border: none;
            width: 100%;
            padding: 18px;
            font-size: 1.4rem;
            font-weight: 600;
            color: #1e2b36;
            border-radius: 50px;
            margin: 10px 0;
            box-shadow: 0 8px 0 #8f6f2c;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .save-btn:active {
            transform: translateY(5px);
            box-shadow: 0 3px 0 #8f6f2c;
        }

        .export-btn {
            background: transparent;
            border: 2px solid #c9a03d;
            color: #1e2b36;
            padding: 12px;
            border-radius: 40px;
            width: 100%;
            font-weight: 600;
            cursor: pointer;
        }

        .footer-note {
            text-align: center;
            font-size: 0.8rem;
            color: #8e7b5e;
            margin: 20px 0 5px;
        }
    </style>
</head>
<body>
<div class="app-container" id="app">
    <div class="header">
        <h1>RAMADAN 30 <span>Dhikr & Namaze</span></h1>
    </div>

    <div class="day-nav">
        <button class="nav-btn" id="prevDay">‚Üê</button>
        <div class="day-display" id="dayDisplay">Dita 1 <small>1 Ramazan</small></div>
        <button class="nav-btn" id="nextDay">‚Üí</button>
    </div>

    <div class="content" id="content">
        <!-- will be filled by js -->
    </div>

    <div style="padding: 0 20px 20px;">
        <button class="save-btn" id="saveBtn">RUAJ</button>
        <button class="export-btn" id="exportBtn">üì§ Eksporto t√´ dh√´nat</button>
        <div class="footer-note">T√´ dh√´nat ruhen lokalisht n√´ telefon</div>
    </div>
</div>

<script>
    (function() {
        // ---------- Struktura e nj√´ dite ----------
        const defaultDay = {
            prayers: {
                fajr: false,
                dhuhr: false,    // emri anglisht, por n√´ shfaqje do p√´rdorim "Dhuhr - Dreka"
                asr: false,
                maghrib: false,
                isha: false,
                taraweeh: false
            },
            quranPages: '',
            quranSurahs: '',
            dhikr: {
                subhanallah: { checked: false, count: '' },
                elhamdulilah: { checked: false, count: '' },
                allahuekber: { checked: false, count: '' },
                estagfirullah: { checked: false, count: '' },
                lailahaillallah_muhammad: { checked: false, count: '' },   // nr.5 (ish 5+6)
                subhanallahi_ve_bi_hamdihi: { checked: false, count: '' }, // nr.6
                hasbijallahu: { checked: false, count: '' },               // nr.7
                lahawle: { checked: false, count: '' },                    // nr.8
                salavatet: { checked: false, count: '' },                  // nr.9
                lailahaillallah_wahdehu: { checked: false, count: '' },    // nr.10
                estagfirullaha_ve_etubu: { checked: false, count: '' },    // nr.11
                allahumma_inni_eseluke: { checked: false, count: '' },     // nr.12
                ihlas_felek_nas: { checked: false, count: '' },            // nr.13
                lailaha_illa_ente: { checked: false, count: '' },          // nr.14
                hasbijallahu_la_ilaha: { checked: false, count: '' }       // nr.15
            },
            dua: '',
            charity: '',
            reflection: ''
        };

        // Inicializo 30 dit√´
        let ramadanData = [];
        for (let i = 0; i < 30; i++) {
            ramadanData.push(JSON.parse(JSON.stringify(defaultDay)));
        }

        // Ngarko nga localStorage n√´se ekziston
        const stored = localStorage.getItem('ramadan30_data_dhikr_v2');
        if (stored) {
            try {
                const parsed = JSON.parse(stored);
                if (Array.isArray(parsed) && parsed.length === 30) {
                    ramadanData = parsed;
                }
            } catch (e) {}
        }

        let currentDay = 0; // 0-based

        // ---------- Render form√´n p√´r dit√´n aktuale ----------
        function renderDay() {
            const d = ramadanData[currentDay];
            const dayNum = currentDay + 1;

            let html = `
                <!-- NAMAZET -->
                <div class="section">
                    <div class="section-title">Namazet</div>
                    <div class="prayer-grid">
                        <div class="prayer-item"><input type="checkbox" id="fajr" ${d.prayers.fajr ? 'checked' : ''}><label for="fajr" class="prayer-name">Fajr <small>Sabahu</small></label></div>
                        <div class="prayer-item"><input type="checkbox" id="dhuhr" ${d.prayers.dhuhr ? 'checked' : ''}><label for="dhuhr" class="prayer-name">Dhuhr <small>Dreka</small></label></div>
                        <div class="prayer-item"><input type="checkbox" id="asr" ${d.prayers.asr ? 'checked' : ''}><label for="asr" class="prayer-name">Asr <small>Ikindija</small></label></div>
                        <div class="prayer-item"><input type="checkbox" id="maghrib" ${d.prayers.maghrib ? 'checked' : ''}><label for="maghrib" class="prayer-name">Maghrib <small>Akshami</small></label></div>
                        <div class="prayer-item"><input type="checkbox" id="isha" ${d.prayers.isha ? 'checked' : ''}><label for="isha" class="prayer-name">Isha <small>Jacia</small></label></div>
                        <div class="prayer-item"><input type="checkbox" id="taraweeh" ${d.prayers.taraweeh ? 'checked' : ''}><label for="taraweeh" class="prayer-name">Taraweeh <small>Teravia</small></label></div>
                    </div>
                </div>

                <!-- KURANI -->
                <div class="section">
                    <div class="section-title">Kurani</div>
                    <div class="input-row"><label>Faqe t√´ lexuara:</label><input type="text" id="quranPages" placeholder="p.sh. 10" value="${escapeHtml(d.quranPages)}"></div>
                    <div class="input-row"><label>Sure / Xhuz:</label><input type="text" id="quranSurahs" placeholder="p.sh. Jasin" value="${escapeHtml(d.quranSurahs)}"></div>
                </div>

                <!-- DHIKR & LUTJE (15 rreshtat) -->
                <div class="section">
                    <div class="section-title">Dhikr & Lutjet</div>
                    <div class="dhikr-grid">
            `;

            // Lista e dhikr-ave me numrat e rinj (1-15)
            const dhikrList = [
                { id: 'subhanallah', label: '1. Subhanallah', arabic: 'ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸÑŸéŸëŸáŸê', defaultCount: '100' },
                { id: 'elhamdulilah', label: '2. Elhamdulilah', arabic: 'ÿßŸÑŸíÿ≠ŸéŸÖŸíÿØŸè ŸÑŸêŸÑŸéŸëŸáŸê', defaultCount: '100' },
                { id: 'allahuekber', label: '3. Allahu Ekber', arabic: 'ÿßŸÑŸÑŸéŸëŸáŸè ÿ£ŸéŸÉŸíÿ®Ÿéÿ±Ÿè', defaultCount: '100' },
                { id: 'estagfirullah', label: '4. Estagfirullah', arabic: 'ÿ£Ÿéÿ≥Ÿíÿ™Ÿéÿ∫ŸíŸÅŸêÿ±Ÿè ÿßŸÑŸÑŸéŸëŸáŸé', defaultCount: '100' },
                { id: 'lailahaillallah_muhammad', label: '5. La ilahe illallah Muhamed Resulullah', arabic: 'ŸÑÿß ÿ•ŸÑŸá ÿ•ŸÑÿß ÿßŸÑŸÑŸá ŸÖÿ≠ŸÖÿØ ÿ±ÿ≥ŸàŸÑ ÿßŸÑŸÑŸá', defaultCount: '' },
                { id: 'subhanallahi_ve_bi_hamdihi', label: '6. SubhanAllahi ve bi hamdihi, SubhanAllahil Adhim', arabic: 'ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸÑŸéŸëŸáŸê ŸàŸéÿ®Ÿêÿ≠ŸéŸÖŸíÿØŸêŸáŸê ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸÑŸéŸëŸáŸê ÿßŸÑŸíÿπŸéÿ∏ŸêŸäŸÖŸê', defaultCount: '' },
                { id: 'hasbijallahu', label: '7. HasbijAllahu ve ni\'mel vekil', arabic: 'ÿ≠Ÿéÿ≥Ÿíÿ®ŸêŸäŸé ÿßŸÑŸÑŸéŸëŸáŸè ŸàŸéŸÜŸêÿπŸíŸÖŸé ÿßŸÑŸíŸàŸéŸÉŸêŸäŸÑŸè', defaultCount: '' },
                { id: 'lahawle', label: '8. La hawle ve la kuvvete illa billah', arabic: 'ŸÑÿß ÿ≠ŸéŸàŸíŸÑŸé ŸàŸéŸÑÿß ŸÇŸèŸàŸéŸëÿ©Ÿé ÿ•ŸêŸÑÿß ÿ®ŸêÿßŸÑŸÑŸéŸëŸáŸê', defaultCount: '' },
                { id: 'salavatet', label: '9. Salavatet (salavate profetit)', arabic: 'ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿµŸéŸÑŸêŸë ÿπŸéŸÑŸéŸâ ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸç', defaultCount: '' },
                { id: 'lailahaillallah_wahdehu', label: '10. La ilahe illallah wahdehu la sherike leh‚Ä¶', arabic: 'ŸÑÿß ÿ•ŸÑŸá ÿ•ŸÑÿß ÿßŸÑŸÑŸá Ÿàÿ≠ÿØŸá ŸÑÿß ÿ¥ÿ±ŸäŸÉ ŸÑŸá...', defaultCount: '' },
                { id: 'estagfirullaha_ve_etubu', label: '11. Estagfirullaha ve etubu ilejh', arabic: 'ÿ£Ÿéÿ≥Ÿíÿ™Ÿéÿ∫ŸíŸÅŸêÿ±Ÿè ÿßŸÑŸÑŸéŸëŸáŸé ŸàŸéÿ£Ÿéÿ™ŸèŸàÿ®Ÿè ÿ•ŸêŸÑŸéŸäŸíŸáŸê', defaultCount: '' },
                { id: 'allahumma_inni_eseluke', label: '12. Allahumme inni es‚Äôeluke‚Äôl xhenneh (7x)', arabic: 'ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ÿ£Ÿéÿ≥Ÿíÿ£ŸéŸÑŸèŸÉŸé ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿé', defaultCount: '7' },
                { id: 'ihlas_felek_nas', label: '13. Ihlas, Felek, Nas', arabic: 'ÿßŸÑÿ•ÿÆŸÑÿßÿµÿå ÿßŸÑŸÅŸÑŸÇÿå ÿßŸÑŸÜÿßÿ≥', defaultCount: '' },
                { id: 'lailaha_illa_ente', label: '14. La ilahe illa ente subhaneke inni kuntu mine dhalimin', arabic: 'ŸÑÿß ÿ•ŸÑŸá ÿ•ŸÑÿß ÿ£ŸÜÿ™ ÿ≥ÿ®ÿ≠ÿßŸÜŸÉ ÿ•ŸÜŸä ŸÉŸÜÿ™ ŸÖŸÜ ÿßŸÑÿ∏ÿßŸÑŸÖŸäŸÜ', defaultCount: '' },
                { id: 'hasbijallahu_la_ilaha', label: '15. HASBIJALLAHU LA ILAHE ILA HUVE‚Ä¶ (teksti i plot√´: Hasbijallahu la ilahe ila huve, alejhi tevekeltu ve huve rabbul arshil adhim)', arabic: 'ÿ≠Ÿéÿ≥Ÿíÿ®ŸêŸäŸé ÿßŸÑŸÑŸéŸëŸáŸè ŸÑŸéÿß ÿ•ŸêŸÑŸéŸáŸé ÿ•ŸêŸÑŸéŸëÿß ŸáŸèŸàŸé ÿπŸéŸÑŸéŸäŸíŸáŸê ÿ™ŸéŸàŸéŸÉŸéŸëŸÑŸíÿ™Ÿè ŸàŸéŸáŸèŸàŸé ÿ±Ÿéÿ®ŸèŸë ÿßŸÑŸíÿπŸéÿ±Ÿíÿ¥Ÿê ÿßŸÑŸíÿπŸéÿ∏ŸêŸäŸÖŸê', defaultCount: '' }
            ];

            dhikrList.forEach(item => {
                const dh = d.dhikr[item.id] || { checked: false, count: '' };
                // N√´se nuk ka count t√´ ruajtur, vendos defaultCount p√´r shfaqje (por nuk e mbishkruan derisa useri shtyp)
                const countValue = (dh.count === '' && item.defaultCount) ? item.defaultCount : dh.count;
                html += `
                    <div class="dhikr-card">
                        <div class="dhikr-check">
                            <input type="checkbox" id="${item.id}_chk" ${dh.checked ? 'checked' : ''}>
                        </div>
                        <div class="dhikr-text">
                            <strong>${item.label}</strong><br>
                            <span class="arabic-note">${item.arabic}</span>
                        </div>
                        <div class="dhikr-counter">
                            <input type="number" id="${item.id}_cnt" min="0" placeholder="num√´r" value="${countValue}">
                        </div>
                    </div>
                `;
            });

            html += `
                    </div> <!-- dhikr-grid -->
                </div>

                <!-- LUTJA E DIT√ãS -->
                <div class="section">
                    <div class="section-title">Lutja e dit√´s</div>
                    <div class="input-row full-width">
                        <textarea id="dua" rows="3" placeholder="Shkruaj lutjen t√´nde...">${escapeHtml(d.dua)}</textarea>
                    </div>
                </div>

                <!-- BAMIR√ãSIA -->
                <div class="section">
                    <div class="section-title">Bamir√´sia (sadeka)</div>
                    <div class="input-row">
                        <input type="text" id="charity" placeholder="√áfar√´ dhe sa?" value="${escapeHtml(d.charity)}">
                    </div>
                </div>

                <!-- REFLEKTIMI -->
                <div class="section">
                    <div class="section-title">Reflektimi ditor</div>
                    <div class="input-row full-width">
                        <textarea id="reflection" rows="4" placeholder="Si u ndje sot? √áfar√´ m√´sove?">${escapeHtml(d.reflection)}</textarea>
                    </div>
                </div>
            `;

            document.getElementById('content').innerHTML = html;
            document.getElementById('dayDisplay').innerHTML = `Dita ${dayNum} <small>${dayNum} Ramazan 1446</small>`;
        }

        // Ndihm√´se p√´r escape HTML
        function escapeHtml(unsafe) {
            if (!unsafe) return '';
            return unsafe.replace(/[&<>"]/g, function(m) {
                if (m === '&') return '&amp;';
                if (m === '<') return '&lt;';
                if (m === '>') return '&gt;';
                if (m === '"') return '&quot;';
                return m;
            });
        }

        // ---------- Ruaj dit√´n aktuale ----------
        function saveCurrentDay() {
            const d = ramadanData[currentDay];

            // Namazet (IDs tani p√´rputhen me emrat anglisht)
            d.prayers.fajr = document.getElementById('fajr')?.checked || false;
            d.prayers.dhuhr = document.getElementById('dhuhr')?.checked || false;
            d.prayers.asr = document.getElementById('asr')?.checked || false;
            d.prayers.maghrib = document.getElementById('maghrib')?.checked || false;
            d.prayers.isha = document.getElementById('isha')?.checked || false;
            d.prayers.taraweeh = document.getElementById('taraweeh')?.checked || false;

            // Kurani
            d.quranPages = document.getElementById('quranPages')?.value || '';
            d.quranSurahs = document.getElementById('quranSurahs')?.value || '';

            // Dhikr (lista e ID-ve)
            const dhikrIds = [
                'subhanallah', 'elhamdulilah', 'allahuekber', 'estagfirullah',
                'lailahaillallah_muhammad', 'subhanallahi_ve_bi_hamdihi', 'hasbijallahu',
                'lahawle', 'salavatet', 'lailahaillallah_wahdehu', 'estagfirullaha_ve_etubu',
                'allahumma_inni_eseluke', 'ihlas_felek_nas', 'lailaha_illa_ente',
                'hasbijallahu_la_ilaha'
            ];

            dhikrIds.forEach(id => {
                const chk = document.getElementById(`${id}_chk`);
                const cnt = document.getElementById(`${id}_cnt`);
                if (chk && cnt) {
                    d.dhikr[id] = {
                        checked: chk.checked,
                        count: cnt.value
                    };
                }
            });

            // Fusha t√´ tjera
            d.dua = document.getElementById('dua')?.value || '';
            d.charity = document.getElementById('charity')?.value || '';
            d.reflection = document.getElementById('reflection')?.value || '';

            // Ruaj n√´ localStorage
            localStorage.setItem('ramadan30_data_dhikr_v2', JSON.stringify(ramadanData));
        }

        // ---------- Event listeners ----------
        document.getElementById('prevDay').addEventListener('click', function() {
            saveCurrentDay();
            if (currentDay > 0) {
                currentDay--;
                renderDay();
            } else {
                alert('Dita e par√´.');
            }
        });

        document.getElementById('nextDay').addEventListener('click', function() {
            saveCurrentDay();
            if (currentDay < 29) {
                currentDay++;
                renderDay();
            } else {
                alert('Keni p√´rfunduar 30 dit√´t!');
            }
        });

        document.getElementById('saveBtn').addEventListener('click', function() {
            saveCurrentDay();
            alert('T√´ dh√´nat u ruajt√´n!');
        });

        document.getElementById('exportBtn').addEventListener('click', function() {
            saveCurrentDay();
            const dataStr = JSON.stringify(ramadanData, null, 2);
            const blob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ramadan30_dhikr_${new Date().toISOString().slice(0,10)}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        // Render fillestar
        renderDay();

        // Ruaj para se t√´ mbyllet
        window.addEventListener('beforeunload', function() {
            saveCurrentDay();
        });
    })();
</script>
</body>
</html>